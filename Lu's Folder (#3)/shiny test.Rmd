---
title: "Untitled"
author: "Lu Liang"
date: "2025-03-13"
output: html_document
---

```{r}
install.packages("shinycssloaders")

```


```{r setup, include=FALSE}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", choices = c("Age", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Mood.Score", "Stress.Level")),
    selectInput("yvar", "选择Y轴变量:", choices = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score"))
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    ggplot(df, aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(df, aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(df, options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", choices = c("Age", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Mood.Score", "Stress.Level")),
    selectInput("yvar", "选择Y轴变量:", choices = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score"))
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    ggplot(df, aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(df, aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    ggplot(df, aes(x = !!sym(input$yvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    ggplot(df, aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_brewer(palette = "Set2")
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(df, options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", choices = c("Age", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Mood.Score", "Stress.Level")),
    selectInput("yvar", "选择Y轴变量:", choices = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_brewer(palette = "Set2")
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)
```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", choices = c("Age", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Mood.Score", "Stress.Level")),
    selectInput("yvar", "选择Y轴变量:", choices = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
  })
  
  # 生成柱状图，增加颜色支持
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", choices = c("Age", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Mood.Score", "Stress.Level")),
    selectInput("yvar", "选择Y轴变量:", choices = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")),
    conditionalPanel(
      condition = "input.xvar == 'Age'",
      sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80))
    ),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df
    if ("ageRange" %in% names(input)) {
      data <- data[data$Age >= input$ageRange[1] & data$Age <= input$ageRange[2], ]
    }
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
  })
  
  # 生成柱状图，增加颜色支持
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level")
                )),
    selectInput("yvar", "选择Y轴变量:", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df
    data <- data[data$Age >= input$ageRange[1] & data$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图（仅限数值变量）
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.") &&
        input$yvar %in% c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")) {
      ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", color = "blue", se = FALSE) +
        theme_minimal() +
        labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
    }
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图（仅限数值变量）
  output$densityPlot <- renderPlot({
    if (input$yvar %in% c("Total.Sleep.Hours", "Sleep.Quality", "Productivity.Score")) {
      ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
        geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
        theme_minimal() +
        labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
    }
  })
  
  # 生成柱状图，增加颜色支持
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "选择Y轴变量:", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours"),
                  "分类变量" = c("Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df
    data <- data[data$Age >= input$ageRange[1] & data$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图（仅限数值变量）
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.") &&
        input$yvar %in% c("Total.Sleep.Hours")) {
      ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", color = "blue", se = FALSE) +
        theme_minimal() +
        labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
    } else {
      showNotification("选择的变量可能不适合用于散点图！", type = "warning")
    }
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图（仅限数值变量）
  output$densityPlot <- renderPlot({
    if (input$yvar %in% c("Total.Sleep.Hours")) {
      ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
        geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
        theme_minimal() +
        labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
    } else {
      showNotification("选择的变量可能不适合用于密度图！", type = "warning")
    }
  })
  
  # 生成柱状图，增加颜色支持
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours"),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "选择Y轴变量:", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."),
                  "分类变量" = c("Sleep.Quality", "Productivity.Score", "Mood.Score", "Stress.Level")
                )),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df
    data <- data[data$Age >= input$ageRange[1] & data$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图（仅限数值变量）
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours") &&
        input$yvar %in% c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.")) {
      ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", color = "blue", se = FALSE) +
        theme_minimal() +
        labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
    } else {
      showNotification("选择的变量可能不适合用于散点图！", type = "warning")
    }
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym(input$yvar))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = input$yvar)
  })
  
  # 生成密度图（仅限数值变量）
  output$densityPlot <- renderPlot({
    if (input$yvar %in% c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.")) {
      ggplot(filtered_df(), aes(x = !!sym(input$yvar), fill = ..density..)) +
        geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
        theme_minimal() +
        labs(title = "密度图 - 数据分布", x = input$yvar, y = "密度")
    } else {
      showNotification("选择的变量可能不适合用于密度图！", type = "warning")
    }
  })
  
  # 生成柱状图，增加颜色支持
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours"),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "选择Y轴变量:", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."),
                  "分类变量" = c("Sleep.Quality", "Productivity.Score", "Mood.Score", "Stress.Level")
                )),
    selectInput("box_xvar", "选择箱线图X轴变量:", choices = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")),
    selectInput("bar_xvar", "选择柱状图X轴变量:", choices = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")),
    selectInput("density_var", "选择密度图变量:", choices = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.")),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore",
              fluidRow(
                box(plotOutput("scatterPlot"), width = 12)
              )
      ),
      tabItem(tabName = "boxplot",
              fluidRow(
                box(plotOutput("boxPlot"), width = 12)
              )
      ),
      tabItem(tabName = "density",
              fluidRow(
                box(plotOutput("densityPlot"), width = 12)
              )
      ),
      tabItem(tabName = "barchart",
              fluidRow(
                box(plotOutput("barChart"), width = 12)
              )
      ),
      tabItem(tabName = "data",
              fluidRow(
                box(DTOutput("dataTable"), width = 12)
              )
      )
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df
    data <- data[data$Age >= input$ageRange[1] & data$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图（仅限数值变量）
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours") &&
        input$yvar %in% c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.")) {
      ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", color = "blue", se = FALSE) +
        theme_minimal() +
        labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
    } else {
      showNotification("选择的变量可能不适合用于散点图！", type = "warning")
    }
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$box_xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$box_xvar, y = "Total Sleep Hours")
  })
  
  # 生成密度图（仅限数值变量）
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$density_var), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$density_var, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$bar_xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$bar_xvar)), fill = as.factor(!!sym(input$bar_xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$bar_xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)
```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("plot_type", "选择图像类型:", 
                choices = c("请选择", "散点图", "箱线图", "密度图", "柱状图")),
    conditionalPanel(
      condition = "input.plot_type == '散点图'",
      selectInput("xvar", "选择X轴变量:", 
                  choices = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours")),
      selectInput("yvar", "选择Y轴变量:", 
                  choices = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."))
    ),
    conditionalPanel(
      condition = "input.plot_type == '箱线图'",
      selectInput("box_xvar", "选择箱线图X轴变量:", 
                  choices = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score"))
    ),
    conditionalPanel(
      condition = "input.plot_type == '密度图'",
      selectInput("density_var", "选择密度图变量:", 
                  choices = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."))
    ),
    conditionalPanel(
      condition = "input.plot_type == '柱状图'",
      selectInput("bar_xvar", "选择柱状图X轴变量:", 
                  choices = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score"))
    ),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(plotOutput("scatterPlot"), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(plotOutput("boxPlot"), width = 12))),
      tabItem(tabName = "density", fluidRow(box(plotOutput("densityPlot"), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(plotOutput("barChart"), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    if (input$plot_type == "散点图") {
      ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
        geom_point(alpha = 0.6) +
        geom_smooth(method = "lm", color = "blue", se = FALSE) +
        theme_minimal() +
        labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
    }
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    if (input$plot_type == "箱线图") {
      ggplot(filtered_df(), aes(x = as.factor(!!sym(input$box_xvar)), y = !!sym("Total.Sleep.Hours"))) +
        geom_boxplot(fill = "lightblue", color = "darkblue") +
        theme_minimal() +
        labs(title = "箱线图 - 变量影响", x = input$box_xvar, y = "Total Sleep Hours")
    }
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    if (input$plot_type == "密度图") {
      ggplot(filtered_df(), aes(x = !!sym(input$density_var), fill = ..density..)) +
        geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
        theme_minimal() +
        labs(title = "密度图 - 数据分布", x = input$density_var, y = "密度")
    }
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    if (input$plot_type == "柱状图") {
      num_colors <- length(unique(filtered_df()[[input$bar_xvar]]))
      color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
      ggplot(filtered_df(), aes(x = as.factor(!!sym(input$bar_xvar)), fill = as.factor(!!sym(input$bar_xvar)))) +
        geom_bar() +
        theme_minimal() +
        labs(title = "柱状图 - 变量分布", x = input$bar_xvar, y = "计数") +
        scale_fill_manual(values = color_palette)
    }
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量:", 
                choices = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")),
    selectInput("yvar", "选择Y轴变量:", 
                choices = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(plotOutput("scatterPlot"), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(plotOutput("boxPlot"), width = 12))),
      tabItem(tabName = "density", fluidRow(box(plotOutput("densityPlot"), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(plotOutput("barChart"), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的X轴变量是分类变量，可能不适合散点图！", type = "warning")
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的Y轴变量是分类变量，可能不适合散点图！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: X轴变量应该是分类变量！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = "Total Sleep Hours")
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的变量是分类变量，可能不适合密度图！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$xvar, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: X轴变量应该是分类变量！", type = "warning")
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量 (数值型变量 | 分类变量):", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours"),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "选择Y轴变量 (数值型变量 | 分类变量):", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins."),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(plotOutput("scatterPlot"), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(plotOutput("boxPlot"), width = 12))),
      tabItem(tabName = "density", fluidRow(box(plotOutput("densityPlot"), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(plotOutput("barChart"), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的X轴变量是分类变量，可能不适合散点图！", type = "warning")
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的Y轴变量是分类变量，可能不适合散点图！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: X轴变量应该是分类变量！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = "Total Sleep Hours")
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: 选择的变量是分类变量，可能不适合密度图！", type = "warning")
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$xvar, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("警告: X轴变量应该是分类变量！", type = "warning")
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)
```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)

# UI 部分
ui <- dashboardPage(
  dashboardHeader(title = "睡眠数据可视化"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("数据探索", tabName = "explore", icon = icon("chart-bar")),
      menuItem("箱线图", tabName = "boxplot", icon = icon("box")),
      menuItem("密度图", tabName = "density", icon = icon("chart-area")),
      menuItem("柱状图", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("数据表格", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "选择X轴变量 (数值型变量 | 分类变量):", 
                choices = list(
                  "数值型变量" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "选择Y轴变量 (数值型变量 | 分类变量):", 
                choices = list(
                  "数值型变量" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "分类变量" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "选择年龄范围:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "选择性别:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(plotOutput("scatterPlot"), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(plotOutput("boxPlot"), width = 12))),
      tabItem(tabName = "density", fluidRow(box(plotOutput("densityPlot"), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(plotOutput("barChart"), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# 服务器部分
server <- function(input, output) {
  
  # 读取数据并修改列名格式
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  # 过滤数据
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  # 生成散点图
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ 警告: 选择的X轴变量是分类变量，可能不适合散点图！", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ 警告: 选择的Y轴变量是分类变量，可能不适合散点图！", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "变量之间的关系", x = input$xvar, y = input$yvar)
  })
  
  # 生成箱线图
  output$boxPlot <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ 警告: X轴变量应该是分类变量！", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "箱线图 - 变量影响", x = input$xvar, y = "Total Sleep Hours")
  })
  
  # 生成密度图
  output$densityPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ 警告: 选择的变量是分类变量，可能不适合密度图！", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "密度图 - 数据分布", x = input$xvar, y = "密度")
  })
  
  # 生成柱状图
  output$barChart <- renderPlot({
    if (!input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ 警告: X轴变量应该是分类变量！", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "柱状图 - 变量分布", x = input$xvar, y = "计数") +
      scale_fill_manual(values = color_palette)
  })
  
  # 显示数据表格
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# 运行应用
shinyApp(ui, server)
```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)

# UI
ui <- dashboardPage(
  dashboardHeader(title = "Sleep Data Visualization"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Data Exploration", tabName = "explore", icon = icon("chart-bar")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("Data Table", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    setBackgroundImage(src = "image.png"),
    tags$head(tags$style("body { background-color: #e6f7ff; } .shiny-notification { font-size: 16px; font-weight: bold; color: red; }")),
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(plotOutput("scatterPlot"), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(plotOutput("boxPlot"), width = 12))),
      tabItem(tabName = "density", fluidRow(box(plotOutput("densityPlot"), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(plotOutput("barChart"), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
  
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# Run the app
shinyApp(ui, server)


```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = "Sleep Data Visualization"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Data Exploration", tabName = "explore", icon = icon("chart-bar")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("Data Table", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #e6f7ff; }
        .shiny-notification {
          font-size: 16px;
          font-weight: bold;
          color: red;
          background-color: yellow;
          border: 2px solid red;
          padding: 10px;
        }
        .content-wrapper {
          background-image: url('image.png');
          background-size: cover;
          background-position: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
  
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# Run the app
shinyApp(ui, server)
```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(DT)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = "Sleep Data Visualization"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Data Exploration", tabName = "explore", icon = icon("chart-bar")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar")),
      menuItem("Data Table", tabName = "data", icon = icon("table"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "explore", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12))),
      tabItem(tabName = "data", fluidRow(box(DTOutput("dataTable"), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
  
  output$dataTable <- renderDT({
    datatable(filtered_df(), options = list(pageLength = 10))
  })
}

# Run the app
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = "Sleep Insights"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("chart-bar")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical, optional for Density Plot):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = NULL),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a boxplot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    if (!is.null(input$yvar)) {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a bar chart!", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
}

# Run the app
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("chart-bar")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical, optional for Density Plot):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = NULL),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a boxplot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    if (!is.null(input$yvar)) {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a bar chart!", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
}

# Run the app
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical. Don't choose any for Density Plot):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = NULL),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = "Relationship Between Variables", x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a boxplot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = "Boxplot - Impact of Variables", x = input$xvar, y = "Total Sleep Hours")
  })
  
  output$densityPlot <- renderPlot({
    if (!is.null(input$yvar)) {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = "Density Plot - Data Distribution", x = input$xvar, y = "Density")
  })
  
  output$barChart <- renderPlot({
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a bar chart!", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = "Bar Chart - Variable Distribution", x = input$xvar, y = "Count") +
      scale_fill_manual(values = color_palette)
  })
}

# Run the app
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Bar Chart", tabName = "barchart", icon = icon("chart-bar"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical, optional for Density Plot):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = NULL),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "barchart", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    plot_title <- paste('Scatter Plot:', input$xvar, 'vs', input$yvar)
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    plot_title <- paste('Boxplot of', input$xvar, 'vs Total Sleep Hours')
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a boxplot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Total Sleep Hours')
  })
  
  output$densityPlot <- renderPlot({
    plot_title <- paste('Density Plot of', input$xvar)
    if (!is.null(input$yvar)) {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Density')
  })
  
  output$barChart <- renderPlot({
    plot_title <- paste('Bar Chart of', input$xvar)
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a bar chart!", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Count') +
      scale_fill_manual(values = color_palette)
  })
}

# Run the app
shinyApp(ui, server)

```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Histogram", tabName = "histogram", icon = icon("chart-bar"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical, optional for Density Plot):", 
                choices = list(
                  "Null" = c("NULL"),
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = "NULL"), 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = NULL),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "histogram", fluidRow(box(withSpinner(plotOutput("barChart")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$scatterPlot <- renderPlot({
    plot_title <- paste('Scatter Plot:', input$xvar, 'vs', input$yvar)
    if (input$xvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected X-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    if (input$yvar %in% c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")) {
      showNotification("⚠️ Warning: The selected Y-axis variable is categorical and may not be suitable for a scatter plot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), y = !!sym(input$yvar))) +
      geom_point(alpha = 0.6) +
      geom_smooth(method = "lm", color = "blue", se = FALSE) +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = input$yvar)
  })
  
  output$boxPlot <- renderPlot({
    plot_title <- paste('Boxplot of', input$xvar, 'vs Total Sleep Hours')
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a histogram!", type = "error", duration = 5)
    }
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a boxplot!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), y = !!sym("Total.Sleep.Hours"))) +
      geom_boxplot(fill = "lightblue", color = "darkblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Total Sleep Hours')
  })
  
  output$densityPlot <- renderPlot({
    plot_title <- paste('Density Plot of', input$xvar)
    if (!is.null(input$yvar) && input$yvar != "NULL") {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    plot_title <- paste('Density Plot of', input$xvar)
    if (!is.null(input$yvar)) {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Density')
  })
  
  output$histogram <- renderPlot({
    plot_title <- paste('Histogram of', input$xvar)
    plot_title <- paste('Bar Chart of', input$xvar)
    if (input$xvar %in% c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day.")) {
      showNotification("⚠️ Warning: The selected X-axis variable is numeric and may not be suitable for a bar chart!", type = "error", duration = 5)
    }
    num_colors <- length(unique(filtered_df()[[input$xvar]]))
    color_palette <- colorRampPalette(brewer.pal(8, "Set2"))(num_colors)
    ggplot(filtered_df(), aes(x = as.factor(!!sym(input$xvar)), fill = as.factor(!!sym(input$xvar)))) +
      geom_bar() +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = 'Count') +
      scale_fill_manual(values = color_palette)
  })
}

# Run the app
shinyApp(ui, server)

```
```{r}

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Histogram", tabName = "histogram", icon = icon("chart-bar")),
      menuItem("Column Plot", tabName = "columnplot", icon = icon("bar-chart"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical, optional for Density Plot):", 
                choices = list(
                  "Null" = "NULL",
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                ), selected = "NULL"),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "histogram", fluidRow(box(withSpinner(plotOutput("histogramPlot")), width = 12))),
      tabItem(tabName = "columnplot", fluidRow(box(withSpinner(plotOutput("columnPlot")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$densityPlot <- renderPlot({
    plot_title <- paste('Density Plot of', input$xvar)
    if (input$yvar != "NULL") {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = "Density")
  })
}

# Run the app
shinyApp(ui, server)

```
```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Histogram", tabName = "histogram", icon = icon("chart-histogram")),
      menuItem("Column Plot", tabName = "columnplot", icon = icon("chart-column"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "histogram", fluidRow(box(withSpinner(plotOutput("histogramPlot")), width = 12))),
      tabItem(tabName = "columnplot", fluidRow(box(withSpinner(plotOutput("columnPlot")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$densityPlot <- renderPlot({
    plot_title <- paste('Density Plot of', input$xvar)
    if (input$yvar != "NULL") {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = "Density")
  })
}

# Run the app
shinyApp(ui, server)
```

```{r}
library(shiny)
library(ggplot2)
library(shinydashboard)
library(reshape2)
library(rlang)
library(RColorBrewer)
library(shinythemes)
library(shinycssloaders)

# UI
ui <- dashboardPage(
  dashboardHeader(title = HTML("<b>Sleep</b>")),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Scatter Plot", tabName = "scatter", icon = icon("braille")),
      menuItem("Boxplot", tabName = "boxplot", icon = icon("box")),
      menuItem("Density Plot", tabName = "density", icon = icon("chart-area")),
      menuItem("Histogram", tabName = "histogram", icon = icon("chart-bar")),
      menuItem("Column Plot", tabName = "columnplot", icon = icon("bar-chart"))
    ),
    selectInput("xvar", "Select X-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Total.Sleep.Hours", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    selectInput("yvar", "Select Y-axis Variable (Numeric | Categorical):", 
                choices = list(
                  "Numeric Variables" = c("Total.Sleep.Hours", "Caffeine.Intake..mg.", "Screen.Time.Before.Bed..mins.", "Exercise..mins.day."),
                  "Categorical Variables" = c("Age", "Mood.Score", "Stress.Level", "Sleep.Quality", "Productivity.Score")
                )),
    sliderInput("ageRange", "Select Age Range:", min = 18, max = 80, value = c(18, 80)),
    selectInput("gender", "Select Gender:", choices = c("All", "Male", "Female", "Other"), selected = "All")
  ),
  dashboardBody(
    tags$head(
      tags$style(HTML("body { background-color: #B7C3D0; }
        .shiny-notification {
          font-size: 18px;
          font-weight: bold;
          color: white;
          background-color: #FF6B6B;
          border: 2px solid #D32F2F;
          padding: 15px;
          text-align: center;
        }"))
    ),
    tabItems(
      tabItem(tabName = "scatter", fluidRow(box(withSpinner(plotOutput("scatterPlot")), width = 12))),
      tabItem(tabName = "boxplot", fluidRow(box(withSpinner(plotOutput("boxPlot")), width = 12))),
      tabItem(tabName = "density", fluidRow(box(withSpinner(plotOutput("densityPlot")), width = 12))),
      tabItem(tabName = "histogram", fluidRow(box(withSpinner(plotOutput("histogramPlot")), width = 12))),
      tabItem(tabName = "columnplot", fluidRow(box(withSpinner(plotOutput("columnPlot")), width = 12)))
    )
  )
)

# Server
server <- function(input, output) {
  
  df <- read.csv("sleep_cycle_productivity.csv", check.names = TRUE)
  
  filtered_df <- reactive({
    data <- df[df$Age >= input$ageRange[1] & df$Age <= input$ageRange[2], ]
    if (input$gender != "All") {
      data <- data[data$Gender == input$gender, ]
    }
    return(data)
  })
  
  output$densityPlot <- renderPlot({
    plot_title <- paste('Density Plot of', input$xvar)
    if (input$yvar != "NULL") {
      showNotification("⚠️ Warning: The density plot does not require a Y-axis variable!", type = "error", duration = 5)
    }
    ggplot(filtered_df(), aes(x = !!sym(input$xvar), fill = ..density..)) +
      geom_density(alpha = 0.6, color = "darkblue", fill = "lightblue") +
      theme_minimal() +
      labs(title = plot_title, x = input$xvar, y = "Density")
  })
}

# Run the app
shinyApp(ui, server)

```

